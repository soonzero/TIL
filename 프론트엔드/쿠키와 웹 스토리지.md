# Cookie(쿠키)와 Web Storage(웹 스토리지)

쿠키와 웹 스토리지 모두 간단한 key와 value를 저장할 수 있는 key-value 형태의 저장소이다.

### Cookie(쿠키)

서버와 클라이언트 간의 지속적인 데이터 교환을 위해 만들어졌다.

저장 시 `expires` 속성을 정의해 무효화시킨다면 삭제될 날짜를 지정할 수 있다.

쿠키의 데이터가 다른 탭과 공유되기 때문에 문제\*가 발생할 수 있다.

**장점**

- 대부분의 브라우저에서 지원한다.

**단점**

- api 호출 시 포함되기 때문에 데이터 낭비가 발생할 수 있고, 서버에 부담이 된다.

- 저장할 수 있는 최대 용량이 쿠키 하나 당 4KB로 작고, 쿠키로 인한 문제 발생을 방지하기 위해 도메인 당 20개의 제한이 있다.

- 암호화 과정이 존재하지 않기 때문에 사용자 정보가 도난당하기 쉽다.

<hr />

### Web Storage(웹 스토리지)

쿠키의 단점을 보완해 탄생한 기술로, 로컬에만 정보를 저장하기 때문에 서버에 불필요하게 데이터를 저장할 필요가 없다.

다음과 같은 메소드를 주로 이용하며, `localStorage`와 `sessionStorage` 모두 사용할 수 있다.

```
localStorage.setItem("key", value) // 저장
sessionStorage.getItem("key") // 조회
localStorage.removeItem("key") // 삭제
sessionStorage.clear() // 전체 삭제
```

만약 한 번에 저장하고 싶다면 `JSON.stringify()`를 해줘야 하고, 불러오려면 `JSON.parse()`를 사용해야 한다.

**장점**

- 서버에 불필요한 데이터를 저장해달라고 요청하지 않아도 되므로, 서버에 부담이 없다.

- 저장 가능한 최대 용량이 크다 (일반적으로 5MB이지만, 브라우저마다 차이가 있다.)

**단점**

- HTML5를 지원하지 않는 브라우저의 경우 사용이 불가능하다.

#### Local Storage(로컬 스토리지)

`window.localStorage`에 위치하고 있다.

브라우저 창을 닫더라도 로그인과 로그아웃의 여부 관계 없이 데이터가 유지된다.

#### Session Storage(세션 스토리지)

브라우저 창을 닫는 순간 데이터가 영구적으로 삭제된다.

<hr />

### 간단 요약

<table>
  <thead>
    <tr>
      <td>구분</td>
      <td>특징</td>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>쿠키</td>
      <td>만료 기한이 있으며, 서버와 지속적으로 통신한다. </td>
    </tr>
    <tr>
      <td>로컬 스토리지</td>
      <td>영구적으로 데이터를 보관한다. </td>
    </tr>
    <tr>
      <td>세션 스토리지</td>
      <td>세션(탭) 종료 시 데이터를 삭제한다. </td>
    </tr>
  </tbody>
</table>

<hr />

### 어떤 유형의 데이터를 어디에 저장하는 것이 좋을까?

- 입력 폼 정보 => 세션 스토리지

- 로그인되지 않은 상태의 장바구니 => 세션 스토리지

- 상세페이지에서 목록 페이지로 이동할 때의 스크롤 위치 값 => 세션 스토리지

- 자동 로그인 기능 => 로컬 스토리지

- 다크 / 라이트 모드 => 로컬 스토리지

- 팝업창 '다시 보지 않기' 선택 기능 => 쿠키

<hr />

### \* 쿠키 사용의 문제

사용자가 로그인 하고 나서 로그아웃을 할 때까지만 사용해야 할 데이터는 일시적으로 필요하지만, 로그인 중에는 지속적으로 사용되어야 한다.

이전에는 이 값들을 쿠키로 관리했으나 쿠키는 다른 탭과도 공유되기 때문에 동일한 사이트에 다른 사용자로 로그인할 경우 문제가 발생하기 쉬웠다.

세션 스토리지를 이용하면 탭 별로 데이터를 관리할 수 있기 때문에 이 문제를 방지할 수 있다.
